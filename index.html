<!DOCTYPE html>
<html>
<head>
    <title>The Commons Community Feed</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://js.arcgis.com/4.28/"></script>
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #1a5f3e 0%, #0a2e1b 100%);
            --accent-gold: #d4a017;
            --neutral-dark: #133B06;
            --neutral-light: #FFFFFF;
            --font-heading: Arial, sans-serif;
            --font-body: Arial, sans-serif;
        }
        body {
            background: var(--primary-gradient);
            color: var(--neutral-light);
            font-family: var(--font-body);
            line-height: 1.6;
            margin: 0;
        }
        .feed-container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 1.5rem;
        }
        .feed-item {
            background: var(--neutral-dark);
            border-left: 4px solid var(--accent-gold);
            border-radius: 12px;
            margin: 2rem 0;
            padding: 1.5rem;
            transition: transform 0.3s ease;
            cursor: pointer;
        }
        .feed-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .feed-header {
            display: flex;
            align-items: center;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .category-icon {
            font-size: 2rem;
            background: var(--accent-gold);
            padding: 12px;
            border-radius: 8px;
            flex-shrink: 0;
        }
        .feed-author {
            font-family: var(--font-heading);
            font-size: 1.5rem;
            color: var(--accent-gold);
            margin: 0;
        }
        .feed-meta {
            color: rgba(255,255,255,0.9);
            font-size: 0.9rem;
            margin: 0.5rem 0;
        }
        .feed-meta span {
            display: inline-block;
            margin-right: 1rem;
        }
        /* Existing lightbox/carousel styles remain unchanged */
    </style>
</head>
<body>
    <div class="feed-container" id="feed">
        <div class="loader"></div>
    </div>

    <script>
        require(["esri/request"], (esriRequest) => {
            const MAIN_LAYER_URL = "https://services7.arcgis.com/glzyAmcOgJqIUWmg/arcgis/rest/services/service_f2459b3aa83c4162a52c6370048b72ea/FeatureServer/0";
            const PHOTO_TABLES = [1, 2, 3, 4];
            
            // Full category icons per brand guidelines
            const CATEGORY_ICONS = {
                yard_sale: 'ğŸ·ï¸',
                classified: 'ğŸ“¦',
                business: 'ğŸ¢',
                csa: 'ğŸ§º',
                farmers_market: 'ğŸ¥•',
                community_garden: 'ğŸŒ±',
                food_pantry: 'ğŸ¥«',
                farm_stand: 'ğŸšœ',
                restaurant: 'ğŸ½ï¸',
                educational_program: 'ğŸ“',
                artisinal: 'ğŸ§€',
                barter_swap: 'ğŸ¤',
                preservation: 'ğŸ«™',
                community_kitchen: 'ğŸ²',
                home_health_center: 'ğŸ¥',
                government_resource: 'ğŸ›ï¸'
            };

            async function loadFeed() {
                // Existing data loading logic...

                // Updated card template with full metadata
                card.innerHTML = `
                    <div class="feed-header">
                        <div class="category-icon">
                            ${CATEGORY_ICONS[feature.attributes.category?.toLowerCase()] || 'âœ¨'}
                        </div>
                        <div>
                            <h2 class="feed-author">${feature.attributes.name || 'Community Listing'}</h2>
                            <div class="feed-meta">
                                ${feature.attributes.county ? `<span>${feature.attributes.county} County</span>` : ''}
                                ${feature.attributes.city ? `<span>${feature.attributes.city}</span>` : ''}
                                ${feature.attributes.listing_duration ? `<span>ğŸ—“ï¸ ${feature.attributes.listing_duration} days</span>` : ''}
                                ${feature.attributes.resource_type ? `<span>ğŸ·ï¸ ${feature.attributes.resource_type}</span>` : ''}
                            </div>
                        </div>
                    </div>
                    <!-- Existing photo grid -->
                `;
            }
        });
    </script>
</body>
</html>
